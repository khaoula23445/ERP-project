<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="shortcut icon" href="assets/images/favicon.svg" type="image/x-icon" />
    <title>Tables | PlainAdmin Demo</title>
   
  
    <style>
      
      .details-row .version-details {
        padding: 10px; background: #f9f9f9; border-left: 3px solid #007bff;
      }
      
    </style>
  <style>
    .modal-content {
        width: 90%; /* Set the width of the modal */
        max-width: 1000px; /* Limit maximum width */
    }
   
    .form-label {
      color: #1A2142;;
    font-weight:500;
    font-size: smaller;
    display: block;
    text-align: left;
    margin-bottom: 5px;
    }

    

    .row.mb-3 {
        margin-bottom: 1rem; /* Reduced space to manage height */
    }
  
</style>
  </style>
    <!-- ========== All CSS files linkup ========= -->
    {% load static %}
<!-- Bootstrap JavaScript Bundle (includes Popper) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6oB8mMQIP1XumxWxF0VS+zY+Lsrl6hW6JARw/s8XKek5tP1Lcv7" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="{% static 'assets/css/bootstrap.min.css' %}" />
    <link rel="stylesheet" href="{% static 'assets/css/lineicons.css' %}" />
    <link rel="stylesheet" href="{% static 'assets/css/materialdesignicons.min.css' %}" />
    <link rel="stylesheet" href="{% static 'assets/css/fullcalendar.css' %}" />
    <link rel="stylesheet" href="{% static 'assets/css/main.css' %}" />
    <link rel="stylesheet" href="{% static 'assets/css/popup.css' %}" />
    <style>
      .dropdown-text {
    font-size: 13px; /* Change the font size as needed */
    padding: 0; /* Adjust padding if necessary */
    margin: 0; /* Adjust margin if necessary */
}

   .table thead th,
.table tbody td {
    text-align: center; /* Center-aligns text within <th> and <td> elements */
}

.table thead th h6 {
    margin: 0;
}
      .small-search {
  width: 200px;
}
.dropdown-menu-small {
    min-width: 100px; /* Adjust this value to your desired width */
    max-width: 130px; /* Optionally, set a max-width */
}


        /* Center the toggle buttons in the middle of the page */
        .table-toggle-buttons {
          display: flex;
          justify-content: center;
          align-items: center;
          gap: 10px;
          margin-bottom: 20px;
        }
    
        .centered-wrapper {
          display: flex;
          justify-content: center;
          align-items: center;
          height: 100vh;
        }
    
        .custom-button {
          font-size: 14px;
          padding: 8px 16px;
        }
      </style>
  </head>
  <body>
    <!-- ======== Preloader =========== -->
    <div id="preloader">
      <div class="spinner"></div>
    </div>
    <!-- ======== Preloader =========== -->

    <!-- ======== sidebar-nav start =========== -->
    {% include 'pages/sidebar.html' %}
    <div class="overlay"></div>
    <!-- ======== sidebar-nav end =========== -->

    <main class="main-wrapper">
      <!-- ========== header start ========== -->
      {% include 'pages/header.html' %}
      <!-- ========== header end ========== -->

   
 
      <!-- ========== table components start ========== -->
      <section class="table-components">
        <div class="container-fluid">
          <div class="title-wrapper pt-30">
            <div class="row align-items-center">
              <div class="col-md-6">
                <div class="title">
                  <h2>Tables</h2>
                </div>
              </div>
              <div class="col-md-6">
                <div class="breadcrumb-wrapper">
                  <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                      <li class="breadcrumb-item">
                        <a href="#0">Dashboard</a>
                      </li>
                      <li class="breadcrumb-item active" aria-current="page">
                        Tables
                      </li>
                    </ol>
                  </nav>
                </div>
              </div>
            </div>
          </div>
      
          <!-- Toggle buttons for switching tables -->
      <div class="table-toggle-buttons">
            <button id="showTable1" class="main-btn primary-btn btn-hover">Table 1</button>
            <button id="showTable2" class="main-btn primary-btn btn-hover">Table 2</button>
          </div>
      
          <!-- Table 1 -->
          <div id="table1" class="tables-wrapper">
            <div class="row">
                <div class="col-lg-12">
                    <div class="card-style mb-30">
                        <div class="d-flex justify-content-between align-items-center mb-10">
                            <h6>Data Table 1</h6>
                            <button id="menu-toggle" class="main-btn primary-btn btn-hover custom-button" onclick="window.location.href='{% url 'add_employee' %}'">
                              <i class="lni lni-plus me-2"></i> Ajouter Employ√©
                          </button>
                          
                          
                        </div>
                        <div class="table-wrapper table-responsive">
                          <table class="table">
                            <thead>
                                <tr>
                                    <div class="d-flex justify-content-between align-items-center mb-3">
                                        <input type="text" id="tableSearch" class="form-control form-control-sm small-search" placeholder="Search..." onkeyup="filterTable()" style="width: 200px;">
                                    </div>
                                </tr>
                                <tr>
                                  <th><h6>id</h6></th>
                                    <th><h6>Employe</h6></th>
                                    <th><h6>securite sociale</h6></th>
                                    <th><h6>telephone</h6></th>
                                    <th><h6>Salaire</h6></th>
                                    <th><h6>Date de naissance</h6></th>
                                    <th><h6>Lieu de naissance</h6></th>
                                    <th><h6>Status</h6></th>
                                    <th><h6>Actions</h6></th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Loop for each employee -->
                                {% for employee in active_employees %}
                                <tr>
                                 
                                  <td class="min-width"><p>{{ employee.id}}</p></td>
                                    <td class="min-width"><p>{{ employee.firstname }} {{ employee.lastname }}</p></td>
                                    <td class="min-width"><p>{{ employee.numss }}</p></td>
                                    <td class="min-width"><p>{{ employee.phone }}</p></td>
                                    <td class="min-width"><p>{{ employee.salary_amount }}</p></td>
                                    <td class="min-width"><p>{{ employee.birth_date }}</p></td>
                                    <td class="min-width"><p>{{ employee.birth_address}}</p></td>
                                    <td class="min-width"><span class="status-btn active-btn">{{ employee.status }}</span></td>
                                    <td class="min-width">
                                      <div class="dropdown">
                                          <button class="btn btn-sm btn-light dropdown-toggle" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
                                              <span class="mdi mdi-dots-vertical"></span>
                                          </button>
                                          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownMenuButton">
                                            <li>
                                                <button class="dropdown-item text-danger d-flex align-items-center" onclick="showDeleteConfirmation('Esther Howard')">
                                                    <span class="dropdown-text">Delete</span>
                                                    <i class="lni lni-trash-can icon-spacing ms-auto"></i>
                                                </button>
                                            </li>
                                            <li>
                                                <button class="dropdown-item d-flex align-items-center" onclick="showLeaveConfirmation('Esther Howard')">
                                                    <span class="dropdown-text">quitter </span>
                                                    <span class="mdi mdi-export icon-spacing ms-auto"></span>
                                                </button>
                                            </li>
                                            <li>
                                              <a href="{% url 'employee_details' employee_id=employee.id %}" class="dropdown-item d-flex align-items-center">
                                                <span class="dropdown-text">details</span>
                                                <span class="mdi mdi-export icon-spacing ms-auto"></span>
                                            </a>
                                          </li>
                                              <button class="dropdown-item d-flex align-items-center" 
    onclick="openEditModal({
        id: '{{ employee.id }}', 
        num_ss: '{{ employee.numss }}',
        type: '{{ employee.type }}',
        firstname: '{{ employee.firstname }}', 
        lastname: '{{ employee.lastname }}', 
        birth_date: '{{ employee.birth_date }}',
        adress: '{{ employee.adress }}',
        phone: '{{ employee.phone }}',
        email: '{{ employee.email }}',
        gendre: '{{ employee.gendre }}',
        situation: '{{ employee.situation }}',
        nbr_child: '{{ employee.nbr_child }}',
        blood_type: '{{ employee.blood_type }}',
        birth_address: '{{ employee.birth_address  }}',
        num_carte: '{{ employee.num_carte }}',
       
        salary_amount: '{{ employee.salary_amount }}', 
        status: '{{ employee.status }}'
    })"
>
    <span class="dropdown-text">Modifier</span>
    <span class="mdi mdi-pencil icon-spacing ms-auto"></span>
</button>

                                          
                                            </li>
                                        </ul>
                                        
                                      </div>
                                  </td>
                                  
                                  
                               
                                  
                                    
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                        
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="editEmployeeModal" tabindex="-1" aria-labelledby="editEmployeeModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-lg"> <!-- Use modal-lg for a wider modal -->
              <div class="modal-content">
                  <form id="editEmployeeForm" method="post" action="{% url 'edit_employee' %}">
                      {% csrf_token %}
                      <div class="modal-header">
                          <h5 class="modal-title" id="editEmployeeModalLabel">Edit Employee</h5>
                          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                      </div>
                      <div class="modal-body">
                          <input type="hidden" name="id" id="employeeId">
                          <div class="row mb-3">
                              <div class="col-md-3">
                                  <label for="num_ss" class="form-label">Numero de securite sociale</label>
                                  <input type="number" class="form-control input-small-text" id="num_ss" name="num_ss" style="font-size: 14px;" required>
                              </div>
                              <div class="col-md-3">
                                  <label for="type" class="form-label">Type</label>
                                  <input type="text" class="form-control input-small-text" id="type" name="type" style="font-size: 14px;" required>
                              </div>
                              <div class="col-md-3">
                                  <label for="firstname" class="form-label">Nom</label>
                                  <input type="text" class="form-control input-small-text" id="firstname" name="firstname" style="font-size: 14px;" required>
                              </div>
                              <div class="col-md-3">
                                  <label for="lastname" class="form-label">Prenom</label>
                                  <input type="text" class="form-control input-small-text" id="lastname" name="lastname"  style="font-size: 14px;"required>
                              </div>
                          </div>
                          <div class="row mb-3">
                              <div class="col-md-3">
                                  <label for="birth_date" class="form-label">Date de naissance</label>
                                  <input type="date" class="form-control input-small-text"id="birth_date" name="birth_date" style="font-size: 14px;" >
                              </div>
                              <div class="col-md-3">
                                  <label for="adress" class="form-label">Address</label>
                                  <input type="text" class="form-control input-small-text" id="adress" name="adress" style="font-size: 14px;"  required>
                              </div>
                              <div class="col-md-3">
                                  <label for="phone" class="form-label">Phone</label>
                                  <input type="text" class="form-control input-small-text"id="phone" name="phone" style="font-size: 14px;" required>
                              </div>
                              <div class="col-md-3">
                                  <label for="email" class="form-label">Email</label>
                                  <input type="email" class="form-control input-small-text"id="email" name="email" style="font-size: 14px;" required>
                              </div>
                          </div>
                          <div class="row mb-3">
                              <div class="col-md-3">
                                  <label for="gendre" class="form-label">Sexe</label>
                                  <input type="text" class="form-control input-small-text" id="gendre" name="gendre" style="font-size: 14px;" >
                              </div>
                              <div class="col-md-3">
                                  <label for="situation" class="form-label">Situation</label>
                                  <input type="text" class="form-control input-small-text" id="situation" name="situation" style="font-size: 14px;" >
                              </div>
                              <div class="col-md-3">
                                  <label for="nbr_child" class="form-label">Nombre d'enfanr</label>
                                  <input type="number" class="form-control input-small-text"id="nbr_child" name="nbr_child"style="font-size: 14px;" >
                              </div>
                              <div class="col-md-3">
                                  <label for="blood_type" class="form-label">Type sanguin</label>
                                  <input type="text" class="form-control input-small-text" id="blood_type" name="blood_type" style="font-size: 14px;" >
                              </div>
                          </div>
                          <div class="row mb-3">
                              <div class="col-md-3">
                                  <label for="birth_address" class="form-label">Address de naissance</label>
                                  <input type="text" class="form-control input-small-text" id="birth_address" name="birth_address"style="font-size: 14px;" >
                              </div>
                              <div class="col-md-3">
                                  <label for="num_carte" class="form-label">Numero de la carte</label>
                                  <input type="number" class="form-control input-small-text"id="num_carte" name="num_carte"style="font-size: 14px;" >
                              </div>
                          </div>
                      </div>
                      <div class="modal-footer">
                          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                          <button type="submit" class="btn btn-primary">Sauvgarder</button>
                      </div>
                  </form>
              </div>
          </div>
      </div>
      
      
        
        <!-- Delete Confirmation Modal -->
        <div class="modal fade" id="deleteConfirmationModal" tabindex="-1" aria-labelledby="deleteConfirmationModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="deleteConfirmationModalLabel">Confirmer la Suppression</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        √ätes-vous s√ªr de vouloir supprimer cet employ√©: <span id="employeeName"></span> ?
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                        <button type="button" class="btn btn-danger" onclick="confirmDelete()">Supprimer</button>
                    </div>
                </div>
            </div>
        </div>
        
          <!-- Table 2 (hidden by default) -->
          <div id="table2" class="tables-wrapper" style="display: none;">
            <div class="row">
              <div class="col-lg-12">
                <div class="card-style mb-30">
                  <div class="d-flex justify-content-between align-items-center mb-10">
                    <h6>Data Table 2</h6>
                    <button id="menu-toggle" class="main-btn primary-btn btn-hover custom-button" data-bs-toggle="modal" data-bs-target="#addEmployeeModal">
                      <i class="lni lni-plus me-2"></i> Ajouter Employ√©
                    </button>
                  </div>
                  <div class="table-wrapper table-responsive">
                    <table class="table">
                      <!-- Table structure for Table 2 (you can modify the data if necessary) -->
                      <thead>
                        <!-- Column headers -->
                      </thead>
                      <tbody>
                        <!-- Table data rows -->
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
      
      <!-- ========== table components end ========== -->

      <!-- ========== footer start =========== -->
  
      <!-- ========== footer end =========== -->
    </main>
    <!-- ======== main-wrapper end =========== -->

    <!-- ========= All Javascript files linkup ======== -->

    <script src="{% static 'assets/js/bootstrap.bundle.min.js' %}"></script>
    <script src="{% static 'assets/js/Chart.min.js' %}"></script>
    <script src="{% static 'assets/js/dynamic-pie-chart.js' %}"></script>
    <script src="{% static 'assets/js/moment.min.js' %}"></script>
    <script src="{% static 'assets/js/fullcalendar.js' %}"></script>
    <script src="{% static 'assets/js/jvectormap.min.js' %}"></script>
    <script src="{% static 'assets/js/world-merc.js' %}"></script>
    <script src="{% static 'assets/js/polyfill.js' %}"></script>
    <script src="{% static 'assets/js/main.js' %}"></script>
  </body>

  <script>
    function showDeleteConfirmation(employeeName, employeeId) {
        document.getElementById('employeeName').textContent = employeeName;
        const deleteButton = document.querySelector('#deleteConfirmationModal .btn-danger');
        deleteButton.setAttribute('onclick', `confirmDelete('${employeeId}')`);
        var deleteModal = new bootstrap.Modal(document.getElementById('deleteConfirmationModal'));
        deleteModal.show();
    }
    
    function confirmDelete(employeeId) {
        // Make an AJAX call to delete the employee
        fetch(`/delete_employee/${employeeId}/`, {
            method: 'DELETE',
            headers: {
                'X-CSRFToken': '{{ csrf_token }}',
                'Content-Type': 'application/json',
            },
        })
        .then(response => {
            if (response.ok) {
                // Optionally, refresh the page or remove the employee from the table
                window.location.reload(); // Refresh the page to see changes
            } else {
                alert('Error deleting employee');
            }
        })
        .catch(error => {
            console.error('Error:', error);
        });
    }
    
    </script>
   <script>
   function openEditModal(employee) {
    // Populate modal fields with employee data
    document.getElementById("employeeId").value = employee.id;
    document.getElementById("num_ss").value = employee.num_ss;
    document.getElementById("type").value = employee.type;
    document.getElementById("firstname").value = employee.firstname;
    document.getElementById("lastname").value = employee.lastname;

    // Handle the birth date correctly
    if (employee.birth_date) {
        const date = new Date(employee.birth_date);
        document.getElementById("birth_date").value = date.toISOString().split('T')[0]; // Ensure it is in YYYY-MM-DD format
    } else {
        document.getElementById("birth_date").value = ''; // Clear the field if no date is provided
    }

    document.getElementById("adress").value = employee.adress;
    document.getElementById("phone").value = employee.phone;
    document.getElementById("email").value = employee.email;
    document.getElementById("gendre").value = employee.gendre;
    document.getElementById("situation").value = employee.situation;
    document.getElementById("nbr_child").value = employee.nbr_child;
    document.getElementById("blood_type").value = employee.blood_type;
    document.getElementById("birth_address").value = employee.birth_address;
    document.getElementById("num_carte").value = employee.num_carte;

    // Show the modal
    let editModal = new bootstrap.Modal(document.getElementById('editEmployeeModal'));
    editModal.show();
}

    </script>
    
</html>
